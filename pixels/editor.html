<style>
body,html{
display:grid;
margin:0 auto;
}
#c{
height:100vh;
image-rendering:-moz-crisp-edges;
image-rendering:-webkit-crisp-edges;
image-rendering:pixelated;
image-rendering:crisp-edges;
}
</style>
<canvas id=c></canvas>
<div>
<input id=U type=file>
<button type=button id=D>Download</button>
<a id=L download=robrots.png></a>
</div>
<script type=text/javascript>
x=c.getContext('2d')
I=new Image()
I.onload=_=>x.drawImage(I,0,0,c.width=I.width,c.height=I.height)
I.src="templates/128x96-comp.png"
U.onchange=e=>{
r=new FileReader()
r.onload=f=>I.src=f.target.result
r.readAsDataURL(e.target.files[0])
}
D.onclick=e=>{
L.setAttribute('href',c.toDataURL(""))
L.click()
}
c.onmousedown=c.onmousemove=e=>{
if(!e.buttons||e.buttons&2)return
E=e
r=c.getBoundingClientRect()
X=e.x-r.left
X*=c.width/c.offsetWidth
X|=0
Y=e.y-r.top
Y*=c.height/c.offsetHeight
Y|=0
D=x.createImageData(1,1)
x.fillStyle=e.buttons==4?"#FFF":"#000"
x.fillRect(X,Y,1,1)
}
</script>